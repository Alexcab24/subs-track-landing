---
import { supabase } from "../lib/supabase";

if (Astro.request.method === "POST") {
  try {
    const data = await Astro.request.formData();
    const email = data.get("email")?.toString().trim();

    console.log("Email recibido:", email);
    
    const { error } = await supabase.from("waitlist").insert([{ email }]);

  } catch (error) {
    console.error("Error en el servidor:", error);

  }
}
---

<section class="relative overflow-hidden">
  <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24 sm:py-32">
    <div class="text-center">
      <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold text-[#192a56] tracking-tight animate-fade-in">
        Manage Your Subscriptions
        <span class="block text-[#FFD700] animate-fade-up [animation-delay:200ms]">With Ease</span>
      </h1>
      <p class="mt-6 text-xl text-gray-600 max-w-3xl mx-auto animate-fade-up">
        Track all your subscriptions in one place. Never miss a payment or renewal date again.
      </p>
    </div>

    <div class="mt-12 max-w-md mx-auto animate-fade-up">
      <form method="POST" class="sm:flex sm:gap-x-4" id="waitlist-form">
        <div class="flex-1">
          <label for="email" class="sr-only">Email address</label>
          <input
            type="email"
            name="email"
            id="email"
            autocomplete="email"
            required
            class="w-full bg-white rounded-lg border border-gray-200 px-4 py-3 text-base text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-[#FFD700] focus:border-transparent transition-all duration-300 hover:border-[#FFD700]"
            placeholder="Enter your email"
          />
        </div>
        <div class="mt-3 sm:mt-0">
          <button
            type="submit"
            class="w-full flex justify-center items-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-[#192a56] bg-[#FFD700] hover:bg-[#E6C84F] focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#FFD700] transition-all duration-300 hover:scale-105 active:scale-95"
          >
            Join Waitlist
          </button>
        </div>
      </form>
    </div>
  </div>
</section>

